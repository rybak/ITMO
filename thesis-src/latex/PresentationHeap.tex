\AgdaHide{

\begin{code}\>\<%
\\
\>\AgdaKeyword{module} \AgdaModule{PresentationHeap} \AgdaKeyword{where}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{AgdaDescription}\<%
\\
\>\<\end{code}
}

\begin{frame}
\begin{code}\>\<%
\\
\>\AgdaKeyword{data} \AgdaDatatype{⊥} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaKeyword{where} \AgdaComment{-- пустой тип}\<%
\\
\>\<\end{code}
\AgdaHide{
\begin{code}\>\<%
\\
\>\AgdaKeyword{module} \AgdaModule{Level} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{postulate} \AgdaPostulate{Level} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{postulate} \AgdaPostulate{lzero} \AgdaSymbol{:} \AgdaPostulate{Level}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{postulate} \AgdaPostulate{lsucc} \AgdaSymbol{:} \AgdaPostulate{Level} \AgdaSymbol{→} \AgdaPostulate{Level}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{postulate} \AgdaPostulate{\_⊔\_} \<[18]%
\>[18]\AgdaSymbol{:} \AgdaPostulate{Level} \AgdaSymbol{→} \AgdaPostulate{Level} \AgdaSymbol{→} \AgdaPostulate{Level}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{infixl} \AgdaNumber{6} \_⊔\_\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{-\#} \AgdaKeyword{BUILTIN} LEVEL     \AgdaPostulate{Level} \AgdaSymbol{\#-\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{-\#} \AgdaKeyword{BUILTIN} LEVELZERO \AgdaPrimitive{lzero} \AgdaSymbol{\#-\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{-\#} \AgdaKeyword{BUILTIN} LEVELSUC  \AgdaPrimitive{lsucc} \AgdaSymbol{\#-\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{-\#} \AgdaKeyword{BUILTIN} LEVELMAX  \AgdaPrimitive{\_⊔\_} \<[30]%
\>[30]\AgdaSymbol{\#-\}}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{Level}\<%
\\
\>\AgdaFunction{\_∘\_} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b} \AgdaBound{c}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{B} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaBound{b}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{C} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaBound{c}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{B} \AgdaSymbol{→} \AgdaBound{C}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{A} \AgdaSymbol{→} \AgdaBound{B}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{A} \AgdaSymbol{→} \AgdaBound{C}\AgdaSymbol{)}\<%
\\
\>\AgdaBound{f} \AgdaFunction{∘} \AgdaBound{g} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{x} \AgdaSymbol{→} \AgdaBound{f} \AgdaSymbol{(}\AgdaBound{g} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{flip} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b} \AgdaBound{c}\AgdaSymbol{\}}\<%
\\
\>[4]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaSymbol{→} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{B} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaBound{b}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{C} \AgdaSymbol{:} \AgdaBound{A} \AgdaSymbol{→} \AgdaBound{B} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{c}\AgdaSymbol{\}} \<[51]%
\>[51]\<%
\\
\>[4]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaSymbol{→} \AgdaSymbol{((}\AgdaBound{x} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{y} \AgdaSymbol{:} \AgdaBound{B}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{C} \AgdaBound{x} \AgdaBound{y}\AgdaSymbol{)}\<%
\\
\>[4]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaSymbol{→} \AgdaSymbol{((}\AgdaBound{y} \AgdaSymbol{:} \AgdaBound{B}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{C} \AgdaBound{x} \AgdaBound{y}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{flip} \AgdaBound{f} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{=} \AgdaBound{f} \AgdaBound{y} \AgdaBound{x}\<%
\\
\>\<\end{code}}
\begin{code}\>\<%
\\
\>\AgdaFunction{¬} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{a} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{a} \AgdaComment{-- Логическое отрицание}\<%
\\
\>\AgdaFunction{¬} \AgdaBound{P} \AgdaSymbol{=} \AgdaBound{P} \AgdaSymbol{→} \AgdaDatatype{⊥}\<%
\\
\>\AgdaFunction{contraposition} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{A} \AgdaBound{B} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaComment{-- Контрапозиция}\<%
\\
\>[-1]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{A} \AgdaSymbol{→} \AgdaBound{B}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaFunction{¬} \AgdaBound{B} \AgdaSymbol{→} \AgdaFunction{¬} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{contraposition} \AgdaSymbol{=} \AgdaFunction{flip} \AgdaFunction{\_∘\_}\<%
\\
\>\AgdaKeyword{data} \AgdaDatatype{\_≡\_} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{)} \AgdaSymbol{:} \AgdaBound{A} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{a} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{refl} \AgdaSymbol{:} \AgdaBound{x} \AgdaDatatype{≡} \AgdaBound{x} \AgdaComment{-- Пропозициональное равенство }\<%
\\
\>\AgdaFunction{cong} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{A} \AgdaBound{B} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{∀} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaBound{A} \AgdaSymbol{→} \AgdaBound{B}\AgdaSymbol{)} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{≡} \AgdaBound{y} \AgdaSymbol{→} \AgdaBound{f} \AgdaBound{x} \AgdaDatatype{≡} \AgdaBound{f} \AgdaBound{y} \AgdaComment{-- Конгруэнтность}\<%
\\
\>\AgdaFunction{cong} \AgdaBound{f} \AgdaInductiveConstructor{refl} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
\begin{code}\>\<%
\\
\>\AgdaKeyword{record} \AgdaRecord{Σ} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaBound{a}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{B} \AgdaSymbol{:} \AgdaBound{A} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaSymbol{(}\AgdaBound{a} \AgdaPrimitive{⊔} \AgdaBound{b}\AgdaSymbol{)} \AgdaKeyword{where} \AgdaComment{-- Зависимая пара}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{constructor} \AgdaInductiveConstructor{\_,\_}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{field} \AgdaField{fst} \AgdaSymbol{:} \AgdaBound{A} \AgdaSymbol{;} \AgdaField{snd} \AgdaSymbol{:} \AgdaBound{B} \AgdaBound{fst}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{Σ}\<%
\\
%
\\
\>\AgdaFunction{\_×\_} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaBound{a}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{B} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaBound{b}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaSymbol{(}\AgdaBound{a} \AgdaPrimitive{⊔} \AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>\AgdaBound{A} \AgdaFunction{×} \AgdaBound{B} \AgdaSymbol{=} \AgdaRecord{Σ} \AgdaBound{A} \AgdaSymbol{(λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaBound{B}\AgdaSymbol{)} \AgdaComment{-- Декартово произведение}\<%
\\
\>\AgdaKeyword{infixr} \AgdaNumber{5} \_×\_ \_,\_\<%
\\
\>\<\end{code}
\end{frame}
\begin{frame}
  \frametitle{Отношения}
\begin{code}\>\<%
\\
\>\AgdaFunction{Rel₂} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaSymbol{→} \AgdaPrimitiveType{Set₁}\<%
\\
\>\AgdaFunction{Rel₂} \AgdaBound{A} \AgdaSymbol{=} \AgdaBound{A} \AgdaSymbol{→} \AgdaBound{A} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{Трихотомия}
\begin{code}\>\<%
\\
\>\AgdaKeyword{data} \AgdaDatatype{Tri} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{\_<\_} \AgdaBound{\_==\_} \AgdaBound{\_>\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{a} \AgdaBound{b} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{tri<} \AgdaSymbol{:} \<[11]%
\>[11]\AgdaSymbol{(}\AgdaBound{a} \AgdaBound{<} \AgdaBound{b}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{¬} \AgdaSymbol{(}\AgdaBound{a} \AgdaBound{==} \AgdaBound{b}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{¬} \AgdaSymbol{(}\AgdaBound{a} \AgdaBound{>} \AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{Tri} \AgdaBound{\_<\_} \AgdaBound{\_==\_} \AgdaBound{\_>\_} \AgdaBound{a} \AgdaBound{b} \AgdaComment{-- меньше}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{tri=} \AgdaSymbol{:} \AgdaFunction{¬} \AgdaSymbol{(}\AgdaBound{a} \AgdaBound{<} \AgdaBound{b}\AgdaSymbol{)} \AgdaSymbol{→} \<[23]%
\>[23]\AgdaSymbol{(}\AgdaBound{a} \AgdaBound{==} \AgdaBound{b}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{¬} \AgdaSymbol{(}\AgdaBound{a} \AgdaBound{>} \AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{Tri} \AgdaBound{\_<\_} \AgdaBound{\_==\_} \AgdaBound{\_>\_} \AgdaBound{a} \AgdaBound{b} \AgdaComment{-- равно}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{tri>} \AgdaSymbol{:} \AgdaFunction{¬} \AgdaSymbol{(}\AgdaBound{a} \AgdaBound{<} \AgdaBound{b}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{¬} \AgdaSymbol{(}\AgdaBound{a} \AgdaBound{==} \AgdaBound{b}\AgdaSymbol{)} \AgdaSymbol{→} \<[36]%
\>[36]\AgdaSymbol{(}\AgdaBound{a} \AgdaBound{>} \AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{Tri} \AgdaBound{\_<\_} \AgdaBound{\_==\_} \AgdaBound{\_>\_} \AgdaBound{a} \AgdaBound{b} \AgdaComment{-- больше}\<%
\\
\>\<\end{code} 
\end{frame}

\begin{frame}
  \frametitle{Компаратор}
\begin{code}\>\>[0]\AgdaIndent{1}{}\<[1]%
\>[1]\<%
\\
\>\AgdaFunction{flip₁} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{A} \AgdaBound{B} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{C} \AgdaSymbol{:} \AgdaPrimitiveType{Set₁}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{A} \AgdaSymbol{→} \AgdaBound{B} \AgdaSymbol{→} \AgdaBound{C}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{B} \AgdaSymbol{→} \AgdaBound{A} \AgdaSymbol{→} \AgdaBound{C}\<%
\\
\>\AgdaFunction{flip₁} \AgdaBound{f} \AgdaBound{a} \AgdaBound{b} \AgdaSymbol{=} \AgdaBound{f} \AgdaBound{b} \AgdaBound{a}\<%
\\
%
\\
\>\AgdaFunction{Cmp} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{Rel₂} \AgdaBound{A} \AgdaSymbol{→} \AgdaFunction{Rel₂} \AgdaBound{A} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaFunction{Cmp} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}} \AgdaBound{\_<\_} \AgdaBound{\_==\_} \AgdaSymbol{=} \AgdaSymbol{∀} \AgdaSymbol{(}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaDatatype{Tri} \AgdaSymbol{(}\AgdaBound{\_<\_}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{\_==\_}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{flip₁} \AgdaBound{\_<\_}\AgdaSymbol{)} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>\<\end{code} 
\end{frame}

\begin{frame}
  \frametitle{Пример отношения}
\begin{code}\>\<%
\\
\>\AgdaKeyword{data} \AgdaDatatype{\_ℕ≤\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaDatatype{ℕ} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{z≤n} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaInductiveConstructor{zero} \AgdaDatatype{ℕ≤} \AgdaBound{n}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{s≤s} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{n} \AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{n} \AgdaDatatype{ℕ≤} \AgdaBound{m} \AgdaSymbol{→} \AgdaInductiveConstructor{succ} \AgdaBound{n} \AgdaDatatype{ℕ≤} \AgdaInductiveConstructor{succ} \AgdaBound{m}\<%
\\
%
\\
\>\AgdaFunction{\_ℕ<\_} \AgdaFunction{\_ℕ≥\_} \AgdaFunction{\_ℕ>\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaDatatype{ℕ}\<%
\\
\>\AgdaBound{n} \AgdaFunction{ℕ<} \AgdaBound{m} \AgdaSymbol{=} \AgdaInductiveConstructor{succ} \AgdaBound{n} \AgdaDatatype{ℕ≤} \AgdaBound{m}\<%
\\
\>\AgdaBound{n} \AgdaFunction{ℕ>} \AgdaBound{m} \AgdaSymbol{=} \AgdaBound{m} \AgdaFunction{ℕ<} \AgdaBound{n}\<%
\\
\>\AgdaBound{n} \AgdaFunction{ℕ≥} \AgdaBound{m} \AgdaSymbol{=} \AgdaBound{m} \AgdaDatatype{ℕ≤} \AgdaBound{n}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{Пример компаратора}
\begin{code}\>\<%
\\
\>\AgdaFunction{lemma-succ-≡} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaInductiveConstructor{succ} \AgdaBound{n} \AgdaDatatype{≡} \AgdaInductiveConstructor{succ} \AgdaBound{m} \AgdaSymbol{→} \AgdaBound{n} \AgdaDatatype{≡} \AgdaBound{m}\<%
\\
\>\AgdaFunction{lemma-succ-≡} \AgdaInductiveConstructor{refl} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma-succ-≤} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaInductiveConstructor{succ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{n}\AgdaSymbol{)} \AgdaDatatype{ℕ≤} \AgdaInductiveConstructor{succ} \AgdaBound{m} \AgdaSymbol{→} \AgdaInductiveConstructor{succ} \AgdaBound{n} \AgdaDatatype{ℕ≤} \AgdaBound{m}\<%
\\
\>\AgdaFunction{lemma-succ-≤} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaBound{r}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaBound{r}\<%
\\
\>\<\end{code} 
\end{frame}

\begin{frame}
\begin{code}\>\<%
\\
\>\AgdaFunction{cmpℕ} \AgdaSymbol{:} \AgdaFunction{Cmp} \AgdaSymbol{\{}\AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaFunction{\_ℕ<\_} \AgdaDatatype{\_≡\_}\<%
\\
\>\AgdaFunction{cmpℕ} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaInductiveConstructor{zero}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{tri=} \AgdaSymbol{(λ} \AgdaSymbol{())} \AgdaInductiveConstructor{refl} \AgdaSymbol{(λ} \AgdaSymbol{())}\<%
\\
\>\AgdaFunction{cmpℕ} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{tri<} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaInductiveConstructor{z≤n}\AgdaSymbol{)} \AgdaSymbol{(λ} \AgdaSymbol{())} \AgdaSymbol{(λ} \AgdaSymbol{())}\<%
\\
\>\AgdaFunction{cmpℕ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{x}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaSymbol{=} \AgdaInductiveConstructor{tri>} \AgdaSymbol{(λ} \AgdaSymbol{())} \AgdaSymbol{(λ} \AgdaSymbol{())} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaInductiveConstructor{z≤n}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{cmpℕ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{y}\AgdaSymbol{)} \AgdaKeyword{with} \AgdaFunction{cmpℕ} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{tri<} \<[12]%
\>[12]\AgdaBound{a} \AgdaBound{¬b} \AgdaBound{¬c} \AgdaSymbol{=} \AgdaInductiveConstructor{tri<} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaBound{a}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(}\AgdaFunction{contraposition} \AgdaFunction{lemma-succ-≡} \AgdaBound{¬b}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(}\AgdaFunction{contraposition} \AgdaFunction{lemma-succ-≤} \AgdaBound{¬c}\AgdaSymbol{)}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{tri>} \AgdaBound{¬a} \AgdaBound{¬b} \<[18]%
\>[18]\AgdaBound{c} \AgdaSymbol{=} \AgdaInductiveConstructor{tri>}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(}\AgdaFunction{contraposition} \AgdaFunction{lemma-succ-≤} \AgdaBound{¬a}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(}\AgdaFunction{contraposition} \AgdaFunction{lemma-succ-≡} \AgdaBound{¬b}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaBound{c}\AgdaSymbol{)}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{tri=} \AgdaBound{¬a} \<[15]%
\>[15]\AgdaBound{b} \AgdaBound{¬c} \AgdaSymbol{=} \AgdaInductiveConstructor{tri=}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(}\AgdaFunction{contraposition} \AgdaFunction{lemma-succ-≤} \AgdaBound{¬a}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(}\AgdaFunction{cong} \AgdaInductiveConstructor{succ} \AgdaBound{b}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{contraposition} \AgdaFunction{lemma-succ-≤} \AgdaBound{¬c}\AgdaSymbol{)}\<%
\\
\>\<\end{code} 
\end{frame}

\section{Свойства отношений}

\begin{frame}
  \frametitle{Транзитивность и симметричность}
\begin{code}\>\<%
\\
\>\AgdaFunction{Trans} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{Rel₂} \AgdaBound{A} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaFunction{Trans} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}} \AgdaBound{\_rel\_} \AgdaSymbol{=} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b} \AgdaBound{c} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{a} \AgdaBound{rel} \AgdaBound{b}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{b} \AgdaBound{rel} \AgdaBound{c}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{a} \AgdaBound{rel} \AgdaBound{c}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{Symmetric} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{Rel₂} \AgdaBound{A} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaFunction{Symmetric} \AgdaBound{\_rel\_} \AgdaSymbol{=} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{a} \AgdaBound{rel} \AgdaBound{b} \AgdaSymbol{→} \AgdaBound{b} \AgdaBound{rel} \AgdaBound{a}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
\begin{code}\>\<%
\\
\>\AgdaFunction{\_Respects\_} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{ℓ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{A} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{ℓ}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{Rel₂} \AgdaBound{A} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaSymbol{\_}\<%
\\
\>\AgdaBound{P} \AgdaFunction{Respects} \AgdaBound{\_rel\_} \AgdaSymbol{=} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{x} \AgdaBound{rel} \AgdaBound{y} \AgdaSymbol{→} \AgdaBound{P} \AgdaBound{x} \AgdaSymbol{→} \AgdaBound{P} \AgdaBound{y}\<%
\\
%
\\
\>\AgdaFunction{\_Respects₂\_} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaFunction{Rel₂} \AgdaBound{A} \AgdaSymbol{→} \AgdaFunction{Rel₂} \AgdaBound{A} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaBound{P} \AgdaFunction{Respects₂} \AgdaBound{\_rel\_} \AgdaSymbol{=}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(∀} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{P} \AgdaBound{x} \<[20]%
\>[20]\AgdaFunction{Respects} \AgdaBound{\_rel\_}\AgdaSymbol{)} \AgdaFunction{×}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(∀} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{flip} \AgdaBound{P} \AgdaBound{y} \AgdaFunction{Respects} \AgdaBound{\_rel\_}\AgdaSymbol{)}\<%
\\
\>\<\end{code}
\end{frame}

\section{<=}
\begin{frame}
  \frametitle{Обобщенное <=}
\begin{code}\>\<%
\\
\>\AgdaKeyword{data} \AgdaDatatype{\_<=\_} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{}\AgdaBound{\_<\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{}\AgdaBound{\_==\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{le} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{x} \AgdaBound{<} \AgdaBound{y} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{<=} \AgdaBound{y}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{eq} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{x} \AgdaBound{==} \AgdaBound{y} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{<=} \AgdaBound{y}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{min}
\begin{code}\>\<%
\\
\>\AgdaFunction{min} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{\_<\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{\_==\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{cmp} \AgdaSymbol{:} \AgdaFunction{Cmp} \AgdaBound{\_<\_} \AgdaBound{\_==\_}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{A} \AgdaSymbol{→} \AgdaBound{A} \AgdaSymbol{→} \AgdaBound{A}\<%
\\
\>\AgdaFunction{min} \AgdaBound{cmp} \AgdaBound{x} \AgdaBound{y} \AgdaKeyword{with} \AgdaBound{cmp} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{tri<} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaBound{x}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaBound{y}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{lemma-<=min}
\begin{code}\>\<%
\\
\>\AgdaFunction{lemma-<=min} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{}\AgdaBound{\_<\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}\{}\AgdaBound{\_==\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{}\AgdaBound{cmp} \AgdaSymbol{:} \AgdaFunction{Cmp} \AgdaBound{\_<\_} \AgdaBound{\_==\_}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b} \AgdaBound{c} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_<=\_} \AgdaSymbol{\{}\_<\_ \AgdaSymbol{=} \AgdaBound{\_<\_}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{\_==\_}\AgdaSymbol{\}} \AgdaBound{a} \AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_<=\_} \AgdaSymbol{\{}\_<\_ \AgdaSymbol{=} \AgdaBound{\_<\_}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{\_==\_}\AgdaSymbol{\}} \AgdaBound{a} \AgdaBound{c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_<=\_} \AgdaSymbol{\{}\_<\_ \AgdaSymbol{=} \AgdaBound{\_<\_}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{\_==\_}\AgdaSymbol{\}} \AgdaBound{a} \AgdaSymbol{(}\AgdaFunction{min} \AgdaBound{cmp} \AgdaBound{b} \AgdaBound{c}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{lemma-<=min} \AgdaSymbol{\{}cmp \AgdaSymbol{=} \AgdaBound{cmp}\AgdaSymbol{\}} \AgdaSymbol{\{\_\}} \AgdaSymbol{\{}\AgdaBound{b}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{c}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaBound{ab} \AgdaBound{ac} \AgdaKeyword{with} \AgdaBound{cmp} \AgdaBound{b} \AgdaBound{c}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{tri<} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaBound{ab}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{tri=} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaBound{ac}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{tri>} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaBound{ac}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{min3}
\begin{code}\>\<%
\\
\>\AgdaFunction{min3} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{\_<\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{\_==\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{cmp} \AgdaSymbol{:} \AgdaFunction{Cmp} \AgdaBound{\_<\_} \AgdaBound{\_==\_}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{A} \AgdaSymbol{→} \AgdaBound{A} \AgdaSymbol{→} \AgdaBound{A} \AgdaSymbol{→} \AgdaBound{A}\<%
\\
\>\AgdaFunction{min3} \AgdaBound{cmp} \AgdaBound{x} \AgdaBound{y} \AgdaBound{z} \AgdaKeyword{with} \AgdaBound{cmp} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{tri<} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaFunction{min} \AgdaBound{cmp} \AgdaBound{x} \AgdaBound{z}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaFunction{min} \AgdaBound{cmp} \AgdaBound{y} \AgdaBound{z}\<%
\\
%
\\
\>\AgdaFunction{lemma-<=min3} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{}\AgdaBound{\_<\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}\{}\AgdaBound{\_==\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{}\AgdaBound{cmp} \AgdaSymbol{:} \AgdaFunction{Cmp} \AgdaBound{\_<\_} \AgdaBound{\_==\_}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{a} \AgdaBound{b} \AgdaBound{c} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_<=\_} \AgdaSymbol{\{}\_<\_ \AgdaSymbol{=} \AgdaBound{\_<\_}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{\_==\_}\AgdaSymbol{\}} \AgdaBound{x} \AgdaBound{a}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_<=\_} \AgdaSymbol{\{}\_<\_ \AgdaSymbol{=} \AgdaBound{\_<\_}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{\_==\_}\AgdaSymbol{\}} \AgdaBound{x} \AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_<=\_} \AgdaSymbol{\{}\_<\_ \AgdaSymbol{=} \AgdaBound{\_<\_}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{\_==\_}\AgdaSymbol{\}} \AgdaBound{x} \AgdaBound{c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_<=\_} \AgdaSymbol{\{}\_<\_ \AgdaSymbol{=} \AgdaBound{\_<\_}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{\_==\_}\AgdaSymbol{\}} \AgdaBound{x} \AgdaSymbol{(}\AgdaFunction{min3} \AgdaBound{cmp} \AgdaBound{a} \AgdaBound{b} \AgdaBound{c}\AgdaSymbol{))}\<%
\\
\>\<\end{code}
\end{frame}
\begin{frame}
Доказательство \F{lemma-<=min3}
\begin{code}\>\<%
\\
\>\AgdaFunction{lemma-<=min3} \AgdaSymbol{\{}cmp \AgdaSymbol{=} \AgdaBound{cmp}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{b}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{c}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaBound{xa} \AgdaBound{xb} \AgdaBound{xc} \AgdaKeyword{with} \AgdaBound{cmp} \AgdaBound{a} \AgdaBound{b}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{tri<} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaFunction{lemma-<=min} \AgdaSymbol{\{}cmp \AgdaSymbol{=} \AgdaBound{cmp}\AgdaSymbol{\}} \AgdaBound{xa} \AgdaBound{xc}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{tri=} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaFunction{lemma-<=min} \AgdaSymbol{\{}cmp \AgdaSymbol{=} \AgdaBound{cmp}\AgdaSymbol{\}} \AgdaBound{xb} \AgdaBound{xc}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{tri>} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{=} \AgdaFunction{lemma-<=min} \AgdaSymbol{\{}cmp \AgdaSymbol{=} \AgdaBound{cmp}\AgdaSymbol{\}} \AgdaBound{xb} \AgdaBound{xc}\<%
\\
\>\<\end{code}
\end{frame}
\begin{frame}
  \frametitle{Свойства <=}
\begin{code}\>\<%
\\
\>\AgdaFunction{resp<=} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{\_<\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{}\AgdaBound{\_==\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{resp} \AgdaSymbol{:} \AgdaBound{\_<\_} \AgdaFunction{Respects₂} \AgdaBound{\_==\_}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{trans==} \AgdaSymbol{:} \AgdaFunction{Trans} \AgdaBound{\_==\_}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{sym==} \AgdaSymbol{:} \AgdaFunction{Symmetric} \AgdaBound{\_==\_}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_<=\_} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}\{}\AgdaBound{\_<\_}\AgdaSymbol{\}\{}\AgdaBound{\_==\_}\AgdaSymbol{\})} \AgdaFunction{Respects₂} \AgdaBound{\_==\_}\<%
\\
\>\AgdaFunction{resp<=} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}\{}\AgdaBound{\_<\_}\AgdaSymbol{\}\{}\AgdaBound{\_==\_}\AgdaSymbol{\}} \AgdaBound{resp} \AgdaBound{trans} \AgdaBound{sym} \AgdaSymbol{=} \AgdaFunction{left} \AgdaInductiveConstructor{,} \AgdaFunction{right} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{left} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b} \AgdaBound{c} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{b} \AgdaBound{==} \AgdaBound{c} \AgdaSymbol{→} \AgdaBound{a} \AgdaDatatype{<=} \AgdaBound{b} \AgdaSymbol{→} \AgdaBound{a} \AgdaDatatype{<=} \AgdaBound{c}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{left} \AgdaBound{b=c} \AgdaSymbol{(}\AgdaInductiveConstructor{le} \AgdaBound{a<b}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{le} \AgdaSymbol{(}\AgdaFunction{fst} \AgdaBound{resp} \AgdaBound{b=c} \AgdaBound{a<b}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{left} \AgdaBound{b=c} \AgdaSymbol{(}\AgdaInductiveConstructor{eq} \AgdaBound{a=b}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{eq} \AgdaSymbol{(}\AgdaBound{trans} \AgdaBound{a=b} \AgdaBound{b=c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{right} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b} \AgdaBound{c} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{b} \AgdaBound{==} \AgdaBound{c} \AgdaSymbol{→} \AgdaBound{b} \AgdaDatatype{<=} \AgdaBound{a} \AgdaSymbol{→} \AgdaBound{c} \AgdaDatatype{<=} \AgdaBound{a}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{right} \AgdaBound{b=c} \AgdaSymbol{(}\AgdaInductiveConstructor{le} \AgdaBound{a<b}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{le} \AgdaSymbol{(}\AgdaFunction{snd} \AgdaBound{resp} \AgdaBound{b=c} \AgdaBound{a<b}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{right} \AgdaBound{b=c} \AgdaSymbol{(}\AgdaInductiveConstructor{eq} \AgdaBound{a=b}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{eq} \AgdaSymbol{(}\AgdaBound{trans} \AgdaSymbol{(}\AgdaBound{sym} \AgdaBound{b=c}\AgdaSymbol{)} \AgdaBound{a=b}\AgdaSymbol{)}\<%
\\
\>\<\end{code}
\end{frame}
\begin{frame}
Транзитивность \D{\_<=\_}.
\begin{code}\>\<%
\\
\>\AgdaFunction{trans<=} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{}\AgdaBound{\_<\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{\_==\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaBound{\_<\_} \AgdaFunction{Respects₂} \AgdaBound{\_==\_} \AgdaSymbol{→} \AgdaFunction{Symmetric} \AgdaBound{\_==\_}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaFunction{Trans} \AgdaBound{\_==\_} \AgdaSymbol{→} \AgdaFunction{Trans} \AgdaBound{\_<\_}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{→} \AgdaFunction{Trans} \AgdaSymbol{(}\AgdaDatatype{\_<=\_} \AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}\{}\AgdaBound{\_<\_}\AgdaSymbol{\}\{}\AgdaBound{\_==\_}\AgdaSymbol{\})}\<%
\\
\>\AgdaFunction{trans<=} \AgdaBound{r} \AgdaBound{s} \AgdaBound{t==} \AgdaBound{t<} \AgdaSymbol{(}\AgdaInductiveConstructor{le} \AgdaBound{a<b}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{le} \AgdaBound{b<c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{le} \AgdaSymbol{(}\AgdaBound{t<} \AgdaBound{a<b} \AgdaBound{b<c}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{trans<=} \AgdaBound{r} \AgdaBound{s} \AgdaBound{t==} \AgdaBound{t<} \AgdaSymbol{(}\AgdaInductiveConstructor{le} \AgdaBound{a<b}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{eq} \AgdaBound{b=c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{le} \AgdaSymbol{(}\AgdaFunction{fst} \AgdaBound{r} \AgdaBound{b=c} \AgdaBound{a<b}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{trans<=} \AgdaBound{r} \AgdaBound{s} \AgdaBound{t==} \AgdaBound{t<} \AgdaSymbol{(}\AgdaInductiveConstructor{eq} \AgdaBound{a=b}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{le} \AgdaBound{b<c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{le} \AgdaSymbol{(}\AgdaFunction{snd} \AgdaBound{r} \AgdaSymbol{(}\AgdaBound{s} \AgdaBound{a=b}\AgdaSymbol{)} \AgdaBound{b<c}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{trans<=} \AgdaBound{r} \AgdaBound{s} \AgdaBound{t==} \AgdaBound{t<} \AgdaSymbol{(}\AgdaInductiveConstructor{eq} \AgdaBound{a=b}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{eq} \AgdaBound{b=c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{eq} \AgdaSymbol{(}\AgdaBound{t==} \AgdaBound{a=b} \AgdaBound{b=c}\AgdaSymbol{)}\<%
\\
\>\<\end{code}
\end{frame}

\section{Куча}

\begin{frame}
  \frametitle{Заголовок модуля}
\begin{code}\>\<%
\\
\>\AgdaKeyword{module} \AgdaModule{Heap} \AgdaSymbol{(}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{\_<\_} \AgdaBound{\_==\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(}\AgdaBound{cmp} \AgdaSymbol{:} \AgdaFunction{Cmp} \AgdaBound{\_<\_} \AgdaBound{\_==\_}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(}\AgdaBound{sym==} \AgdaSymbol{:} \AgdaFunction{Symmetric} \AgdaBound{\_==\_}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(}\AgdaBound{trans==} \AgdaSymbol{:} \AgdaFunction{Trans} \AgdaBound{\_==\_}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(}\AgdaBound{trans<} \AgdaSymbol{:} \AgdaFunction{Trans} \AgdaBound{\_<\_}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(}\AgdaBound{resp} \AgdaSymbol{:} \AgdaBound{\_<\_} \AgdaFunction{Respects₂} \AgdaBound{\_==\_}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{where}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{Расширение}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{data} \AgdaDatatype{expanded} \AgdaSymbol{(}\AgdaBound{A} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{)} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{\#} \AgdaSymbol{:} \AgdaBound{A} \AgdaSymbol{→} \AgdaDatatype{expanded} \AgdaBound{A} \AgdaComment{-- (\# x) — элемент исходного типа}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{top} \AgdaSymbol{:} \AgdaDatatype{expanded} \AgdaBound{A} \AgdaComment{-- элемент расширение}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{Расширенные отношения}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{data} \AgdaDatatype{\_<E\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaSymbol{(}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{)} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{base} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{x} \AgdaBound{<} \AgdaBound{y} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaDatatype{<E} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{y}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{ext} \<[9]%
\>[9]\AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaDatatype{<E} \AgdaInductiveConstructor{top}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{data} \AgdaDatatype{\_=E\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaSymbol{(}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{)} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{base} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{x} \AgdaBound{==} \AgdaBound{y} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaDatatype{=E} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{y}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{ext} \<[9]%
\>[9]\AgdaSymbol{:} \AgdaInductiveConstructor{top} \AgdaDatatype{=E} \AgdaInductiveConstructor{top}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{Свойства}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-<E} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaDatatype{<E} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{x} \AgdaBound{<} \AgdaBound{y}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{trans<E} \AgdaSymbol{:} \AgdaFunction{Trans} \AgdaDatatype{\_<E\_}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-=E} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaDatatype{=E} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{x} \AgdaBound{==} \AgdaBound{y}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{sym=E} \<[10]%
\>[10]\AgdaSymbol{:} \AgdaFunction{Symmetric} \AgdaDatatype{\_=E\_}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{trans=E} \AgdaSymbol{:} \AgdaFunction{Trans} \AgdaDatatype{\_=E\_}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{respE} \AgdaSymbol{:} \AgdaDatatype{\_<E\_} \AgdaFunction{Respects₂} \AgdaDatatype{\_=E\_}\<%
\\
\>\<\end{code}\AgdaHide{
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-<E} \AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{r}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaBound{r}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{trans<E} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaBound{a<b} \AgdaBound{b<c} \AgdaSymbol{=}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{base} \AgdaSymbol{(}\AgdaBound{trans<} \AgdaSymbol{(}\AgdaFunction{lemma-<E} \AgdaBound{a<b}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemma-<E} \AgdaBound{b<c}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{trans<E} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{top}\AgdaSymbol{\}} \AgdaSymbol{\_} \<[31]%
\>[31]\AgdaSymbol{\_} \<[34]%
\>[34]\AgdaSymbol{=} \AgdaInductiveConstructor{ext}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{trans<E} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{top}\AgdaSymbol{\}} \AgdaSymbol{\{\_\}} \<[28]%
\>[28]\AgdaSymbol{\_} \<[31]%
\>[31]\AgdaSymbol{()}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{trans<E} \AgdaSymbol{\{}\AgdaInductiveConstructor{top}\AgdaSymbol{\}} \AgdaSymbol{\{\_\}} \<[22]%
\>[22]\AgdaSymbol{\{\_\}} \<[28]%
\>[28]\AgdaSymbol{()} \AgdaSymbol{\_}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-=E} \AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{r}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaBound{r}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{sym=E} \AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{a=b}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{base} \AgdaSymbol{(}\AgdaBound{sym==} \AgdaBound{a=b}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{sym=E} \AgdaInductiveConstructor{ext} \AgdaSymbol{=} \AgdaInductiveConstructor{ext}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{trans=E} \AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{a=b}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{b=c}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{base} \AgdaSymbol{(}\AgdaBound{trans==} \AgdaBound{a=b} \AgdaBound{b=c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{trans=E} \AgdaInductiveConstructor{ext} \AgdaInductiveConstructor{ext} \AgdaSymbol{=} \AgdaInductiveConstructor{ext}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{respE} \AgdaSymbol{=} \AgdaFunction{left} \AgdaInductiveConstructor{,} \AgdaFunction{right} \AgdaKeyword{where}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{left} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b} \AgdaBound{c} \AgdaSymbol{:} \AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{b} \AgdaDatatype{=E} \AgdaBound{c} \AgdaSymbol{→} \AgdaBound{a} \AgdaDatatype{<E} \AgdaBound{b} \AgdaSymbol{→} \AgdaBound{a} \AgdaDatatype{<E} \AgdaBound{c}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{left} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{r1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{r2}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{base} \AgdaSymbol{(}\AgdaFunction{fst} \AgdaBound{resp} \AgdaBound{r1} \AgdaBound{r2}\AgdaSymbol{)}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{left} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{top}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{top}\AgdaSymbol{\}} \AgdaInductiveConstructor{ext} \AgdaInductiveConstructor{ext} \AgdaSymbol{=} \AgdaInductiveConstructor{ext}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{left} \AgdaSymbol{\{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{top}\AgdaSymbol{\}} \AgdaSymbol{()} \AgdaSymbol{\_}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{left} \AgdaSymbol{\{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{top}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{()} \AgdaSymbol{\_}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{left} \AgdaSymbol{\{}\AgdaInductiveConstructor{top}\AgdaSymbol{\}} \AgdaSymbol{\{\_\}} \AgdaSymbol{\{\_\}} \<[25]%
\>[25]\AgdaSymbol{\_} \AgdaSymbol{()}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{right} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b} \AgdaBound{c} \AgdaSymbol{:} \AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{b} \AgdaDatatype{=E} \AgdaBound{c} \AgdaSymbol{→} \AgdaBound{b} \AgdaDatatype{<E} \AgdaBound{a} \AgdaSymbol{→} \AgdaBound{c} \AgdaDatatype{<E} \AgdaBound{a}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{right} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{r1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{r2}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{base} \AgdaSymbol{(}\AgdaFunction{snd} \AgdaBound{resp} \AgdaBound{r1} \AgdaBound{r2}\AgdaSymbol{)}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{right} \AgdaSymbol{\{}\AgdaInductiveConstructor{top}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\_} \AgdaInductiveConstructor{ext} \AgdaSymbol{=} \AgdaInductiveConstructor{ext}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{right} \AgdaSymbol{\{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{\#} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{top}\AgdaSymbol{\}} \AgdaSymbol{()} \AgdaSymbol{\_}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{right} \AgdaSymbol{\{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{top}\AgdaSymbol{\}} \AgdaSymbol{\{\_\}} \AgdaSymbol{\_} \AgdaSymbol{()}\<%
\\
\>\<\end{code}}
\end{frame}

\begin{frame}
  \frametitle{$ \_\leq\_ $}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{\_≤\_} \AgdaSymbol{:} \AgdaFunction{Rel₂} \AgdaSymbol{(}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{\_≤\_} \AgdaSymbol{=} \AgdaDatatype{\_<=\_} \AgdaSymbol{\{}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaDatatype{\_<E\_}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaDatatype{\_=E\_}\AgdaSymbol{\}}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{trans≤} \AgdaSymbol{:} \AgdaFunction{Trans} \AgdaFunction{\_≤\_}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{trans≤} \AgdaSymbol{=} \AgdaFunction{trans<=} \AgdaFunction{respE} \AgdaFunction{sym=E} \AgdaFunction{trans=E} \AgdaFunction{trans<E}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{resp≤} \AgdaSymbol{:} \AgdaFunction{\_≤\_} \AgdaFunction{Respects₂} \AgdaDatatype{\_=E\_}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{resp≤} \AgdaSymbol{=} \AgdaFunction{resp<=} \AgdaFunction{respE} \AgdaFunction{trans=E} \AgdaFunction{sym=E}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{cmpE}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{cmpE} \AgdaSymbol{:} \AgdaFunction{Cmp} \AgdaSymbol{\{}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{\}} \AgdaDatatype{\_<E\_} \AgdaDatatype{\_=E\_}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{cmpE} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{y}\AgdaSymbol{)} \AgdaKeyword{with} \AgdaBound{cmp} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{cmpE} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{|} \AgdaInductiveConstructor{tri<} \AgdaBound{a} \AgdaBound{b} \AgdaBound{c} \AgdaSymbol{=} \AgdaInductiveConstructor{tri<}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{a}\AgdaSymbol{)}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{contraposition} \AgdaFunction{lemma-=E} \AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{contraposition} \AgdaFunction{lemma-<E} \AgdaBound{c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{cmpE} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{|} \AgdaInductiveConstructor{tri=} \AgdaBound{a} \AgdaBound{b} \AgdaBound{c} \AgdaSymbol{=} \AgdaInductiveConstructor{tri=}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{contraposition} \AgdaFunction{lemma-<E} \AgdaBound{a}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{contraposition} \AgdaFunction{lemma-<E} \AgdaBound{c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{cmpE} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{|} \AgdaInductiveConstructor{tri>} \AgdaBound{a} \AgdaBound{b} \AgdaBound{c} \AgdaSymbol{=} \AgdaInductiveConstructor{tri>}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{contraposition} \AgdaFunction{lemma-<E} \AgdaBound{a}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{contraposition} \AgdaFunction{lemma-=E} \AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{c}\AgdaSymbol{)}\<%
\\
\>\<\end{code}
\end{frame}
\begin{frame}
  \frametitle{cmpE}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{cmpE} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaInductiveConstructor{top} \AgdaSymbol{=} \AgdaInductiveConstructor{tri<} \AgdaInductiveConstructor{ext} \AgdaSymbol{(λ} \AgdaSymbol{())} \AgdaSymbol{(λ} \AgdaSymbol{())}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{cmpE} \AgdaInductiveConstructor{top} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{tri>} \AgdaSymbol{(λ} \AgdaSymbol{())} \AgdaSymbol{(λ} \AgdaSymbol{())} \AgdaInductiveConstructor{ext}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{cmpE} \AgdaInductiveConstructor{top} \AgdaInductiveConstructor{top} \<[17]%
\>[17]\AgdaSymbol{=} \AgdaInductiveConstructor{tri=} \AgdaSymbol{(λ} \AgdaSymbol{())} \AgdaInductiveConstructor{ext} \AgdaSymbol{(λ} \AgdaSymbol{())}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{minE}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{minE} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{expanded} \AgdaBound{A}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{minE} \AgdaSymbol{=} \AgdaFunction{min} \AgdaFunction{cmpE}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-<=minE} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b} \AgdaBound{c}\AgdaSymbol{\}} \AgdaSymbol{→} \<[29]%
\>[29]\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaBound{a} \AgdaFunction{≤} \AgdaBound{b} \AgdaSymbol{→} \AgdaBound{a} \AgdaFunction{≤} \AgdaBound{c} \AgdaSymbol{→} \AgdaBound{a} \AgdaFunction{≤} \AgdaSymbol{(}\AgdaFunction{minE} \AgdaBound{b} \AgdaBound{c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-<=minE} \AgdaSymbol{=} \<[17]%
\>[17]\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{lemma-<=min} \AgdaSymbol{\{}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{\}\{}\AgdaDatatype{\_<E\_}\AgdaSymbol{\}\{}\AgdaDatatype{\_=E\_}\AgdaSymbol{\}\{}\AgdaFunction{cmpE}\AgdaSymbol{\}}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{min3E} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{min3E} \AgdaBound{x} \AgdaBound{y} \AgdaBound{z} \AgdaSymbol{=} \AgdaFunction{min3} \AgdaFunction{cmpE} \AgdaBound{x} \AgdaBound{y} \AgdaBound{z}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-<=min3E} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{a} \AgdaBound{b} \AgdaBound{c}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaBound{x} \AgdaFunction{≤} \AgdaBound{a} \AgdaSymbol{→} \AgdaBound{x} \AgdaFunction{≤} \AgdaBound{b} \AgdaSymbol{→} \AgdaBound{x} \AgdaFunction{≤} \AgdaBound{c} \AgdaSymbol{→} \AgdaBound{x} \AgdaFunction{≤} \AgdaSymbol{(}\AgdaFunction{min3E} \AgdaBound{a} \AgdaBound{b} \AgdaBound{c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-<=min3E} \AgdaSymbol{=}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{lemma-<=min3} \AgdaSymbol{\{}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{\}\{}\AgdaDatatype{\_<E\_}\AgdaSymbol{\}\{}\AgdaDatatype{\_=E\_}\AgdaSymbol{\}\{}\AgdaFunction{cmpE}\AgdaSymbol{\}}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{HeapState}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{data} \AgdaDatatype{HeapState} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{full} \AgdaInductiveConstructor{almost} \AgdaSymbol{:} \AgdaDatatype{HeapState}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{Heap}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{data} \AgdaDatatype{Heap} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{)} \AgdaComment{-- минимум}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{h} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{)} \AgdaComment{-- высота}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{HeapState} \AgdaComment{-- заполненность}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{eh} \AgdaSymbol{:} \AgdaDatatype{Heap} \AgdaInductiveConstructor{top} \AgdaInductiveConstructor{zero} \AgdaInductiveConstructor{full} \AgdaComment{-- Пустая куча}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{nf} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{p} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{i} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{p}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{j} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{p}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaBound{y}\AgdaSymbol{)}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{a} \AgdaSymbol{:} \AgdaDatatype{Heap} \AgdaBound{x} \AgdaBound{n} \AgdaInductiveConstructor{full}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{b} \AgdaSymbol{:} \AgdaDatatype{Heap} \AgdaBound{y} \AgdaBound{n} \AgdaInductiveConstructor{full}\AgdaSymbol{)}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{p}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{n}\AgdaSymbol{)} \AgdaInductiveConstructor{full} \AgdaComment{-- Полная куча}\<%
\\
\>\<\end{code}
\begin{center}
\includegraphics{pic/p-nodes-1.pdf}
\end{center}
\end{frame}

\begin{frame}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{nd} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{p} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{i} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{p}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{j} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{p}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaBound{y}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{a} \AgdaSymbol{:} \AgdaDatatype{Heap} \AgdaBound{x} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{n}\AgdaSymbol{)} \AgdaInductiveConstructor{full}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{b} \AgdaSymbol{:} \AgdaDatatype{Heap} \AgdaBound{y} \AgdaBound{n} \AgdaInductiveConstructor{full}\AgdaSymbol{)} \AgdaComment{-- a b разной высоты}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{p}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{n}\AgdaSymbol{))} \AgdaInductiveConstructor{almost}\<%
\\
\>\<\end{code}
\begin{center}
\includegraphics{pic/p-nodes-2.pdf}
\end{center}
\end{frame}

\begin{frame}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{nl} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{p} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{i} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{p}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{j} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{p}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaBound{y}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{a} \AgdaSymbol{:} \AgdaDatatype{Heap} \AgdaBound{x} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{n}\AgdaSymbol{)} \AgdaInductiveConstructor{almost}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{b} \AgdaSymbol{:} \AgdaDatatype{Heap} \AgdaBound{y} \AgdaBound{n} \AgdaInductiveConstructor{full}\AgdaSymbol{)} \AgdaComment{-- b — полная}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{p}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{n}\AgdaSymbol{))} \AgdaInductiveConstructor{almost}\<%
\\
\>\<\end{code}
\begin{center}
\includegraphics{pic/p-nodes-3.pdf}
\end{center}
\end{frame}

\begin{frame}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{nr} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{p} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{i} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{p}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{j} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{p}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaBound{y}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{a} \AgdaSymbol{:} \AgdaDatatype{Heap} \AgdaBound{x} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{n}\AgdaSymbol{)} \AgdaInductiveConstructor{full}\AgdaSymbol{)} \AgdaComment{-- a — полная}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{b} \AgdaSymbol{:} \AgdaDatatype{Heap} \AgdaBound{y} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{n}\AgdaSymbol{)} \AgdaInductiveConstructor{almost}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{p}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{n}\AgdaSymbol{))} \AgdaInductiveConstructor{almost}\<%
\\
\>\<\end{code}
\begin{center}
\includegraphics{pic/p-nodes-4.pdf}
\end{center}
\end{frame}

\begin{frame}
  \frametitle{}
\emph{Замечание}: высота любой неполной кучи больше нуля.
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-almost-height} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{h}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaBound{m} \AgdaBound{h} \AgdaInductiveConstructor{almost} \AgdaSymbol{→} \AgdaBound{h} \AgdaFunction{ℕ>} \AgdaNumber{0}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-almost-height} \AgdaSymbol{(}\AgdaInductiveConstructor{nd} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_)} \AgdaSymbol{=} \AgdaInductiveConstructor{s≤s} \AgdaInductiveConstructor{z≤n}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-almost-height} \AgdaSymbol{(}\AgdaInductiveConstructor{nl} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_)} \AgdaSymbol{=} \AgdaInductiveConstructor{s≤s} \AgdaInductiveConstructor{z≤n}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-almost-height} \AgdaSymbol{(}\AgdaInductiveConstructor{nr} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_)} \AgdaSymbol{=} \AgdaInductiveConstructor{s≤s} \AgdaInductiveConstructor{z≤n}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{peekMin}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{peekMin} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{h} \AgdaBound{s}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaBound{m} \AgdaBound{h} \AgdaBound{s} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{peekMin} \AgdaInductiveConstructor{eh} \AgdaSymbol{=} \AgdaInductiveConstructor{top}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{peekMin} \AgdaSymbol{(}\AgdaInductiveConstructor{nd} \AgdaBound{p} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_)} \AgdaSymbol{=} \AgdaInductiveConstructor{\#} \AgdaBound{p}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{peekMin} \AgdaSymbol{(}\AgdaInductiveConstructor{nf} \AgdaBound{p} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_)} \AgdaSymbol{=} \AgdaInductiveConstructor{\#} \AgdaBound{p}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{peekMin} \AgdaSymbol{(}\AgdaInductiveConstructor{nl} \AgdaBound{p} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_)} \AgdaSymbol{=} \AgdaInductiveConstructor{\#} \AgdaBound{p}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{peekMin} \AgdaSymbol{(}\AgdaInductiveConstructor{nr} \AgdaBound{p} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_)} \AgdaSymbol{=} \AgdaInductiveConstructor{\#} \AgdaBound{p}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{finsert}
Вставка в полную кучу
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{finsert} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{h} \AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{z} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaBound{m} \AgdaBound{h} \AgdaInductiveConstructor{full}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaRecord{Σ} \AgdaDatatype{HeapState} \<[18]%
\>[18]\<%
\\
\>[4]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaSymbol{(}\AgdaDatatype{Heap} \AgdaSymbol{(}\AgdaFunction{minE} \AgdaBound{m} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{z}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{))}\<%
\\
\>\<\end{code}
\end{frame}

\AgdaHide{
\begin{code}\>\<%
\\
\>[2]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{finsert} \AgdaSymbol{=} \AgdaSymbol{\{!!\}}\<%
\\
\>\<\end{code}
}

\begin{frame}
  \frametitle{ainsert}
Вставка в неполную кучу
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{ainsert} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{h} \AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{z} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaBound{m} \AgdaBound{h} \AgdaInductiveConstructor{almost}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaRecord{Σ} \AgdaDatatype{HeapState}\<%
\\
\>[4]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaSymbol{(}\AgdaDatatype{Heap} \AgdaSymbol{(}\AgdaFunction{minE} \AgdaBound{m} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{z}\AgdaSymbol{))} \AgdaBound{h}\AgdaSymbol{)}\<%
\\
\>\<\end{code}
\end{frame}

\AgdaHide{
\begin{code}\>\<%
\\
\>[2]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{ainsert} \AgdaSymbol{=} \AgdaSymbol{\{!!\}}\<%
\\
\>\<\end{code}
}
 
\begin{frame}
  \frametitle{OR}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{data} \AgdaDatatype{OR} \AgdaSymbol{(}\AgdaBound{A} \AgdaBound{B} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{)} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{orA} \AgdaSymbol{:} \AgdaBound{A} \AgdaSymbol{→} \AgdaDatatype{OR} \AgdaBound{A} \AgdaBound{B}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{orB} \AgdaSymbol{:} \AgdaBound{B} \AgdaSymbol{→} \AgdaDatatype{OR} \AgdaBound{A} \AgdaBound{B}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{fmerge}
Слияние двух полных куч одной высоты
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fmerge} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaBound{h}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaBound{x} \AgdaBound{h} \AgdaInductiveConstructor{full} \AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaBound{y} \AgdaBound{h} \AgdaInductiveConstructor{full}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{OR} \AgdaSymbol{(}\AgdaDatatype{Heap} \AgdaBound{x} \AgdaInductiveConstructor{zero} \AgdaInductiveConstructor{full} \AgdaFunction{×} \AgdaSymbol{(}\AgdaBound{x} \AgdaDatatype{≡} \AgdaBound{y}\AgdaSymbol{)} \AgdaFunction{×} \AgdaSymbol{(}\AgdaBound{h} \AgdaDatatype{≡} \AgdaInductiveConstructor{zero}\AgdaSymbol{))}\<%
\\
\>[4]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{(}\AgdaDatatype{Heap} \AgdaSymbol{(}\AgdaFunction{minE} \AgdaBound{x} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{)} \AgdaInductiveConstructor{almost}\AgdaSymbol{)}\<%
\\
\>\<\end{code}
\end{frame}

\AgdaHide{
\begin{code}\>\<%
\\
\>[3]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fmerge} \AgdaSymbol{=} \AgdaSymbol{\{!!\}}\<%
\\
\>\<\end{code}
}
 
\begin{frame}
  \frametitle{fpop}
Извлечение минимума из полной кучи
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fpop} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{h}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaBound{m} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{)} \AgdaInductiveConstructor{full}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{OR}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaRecord{Σ} \AgdaSymbol{(}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{)} \<[20]%
\>[20]\<%
\\
\>[4]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(λ} \AgdaBound{x} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{Heap} \AgdaBound{x} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{)} \AgdaInductiveConstructor{almost}\AgdaSymbol{)} \AgdaFunction{×} \AgdaSymbol{(}\AgdaBound{m} \AgdaFunction{≤} \AgdaBound{x}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaDatatype{Heap} \AgdaInductiveConstructor{top} \AgdaBound{h} \AgdaInductiveConstructor{full}\AgdaSymbol{)}\<%
\\
\>\<\end{code}
\end{frame}

\AgdaHide{
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{fpop} \AgdaSymbol{=} \AgdaSymbol{\{!!\}}\<%
\\
\>\<\end{code}
}
 
\begin{frame}
  \frametitle{makeH}
Составление полной кучи высотой $h+1$ из двух куч высотой $h$ и одного элемента
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{makeH} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaBound{h}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{p} \AgdaSymbol{:} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaBound{x} \AgdaBound{h} \AgdaInductiveConstructor{full} \AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaBound{y} \AgdaBound{h} \AgdaInductiveConstructor{full}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaSymbol{(}\AgdaFunction{min3E} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{p}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{)} \AgdaInductiveConstructor{full}\<%
\\
\>\<\end{code}
\end{frame}

\AgdaHide{
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{makeH} \AgdaSymbol{=} \AgdaSymbol{\{!!\}}\<%
\\
\>\<\end{code}
}

\begin{frame}
  \frametitle{Вспомогательные леммы}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-resp} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaBound{a} \AgdaBound{b}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaBound{x} \AgdaBound{==} \AgdaBound{y} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaBound{a} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaBound{b}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{y}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaFunction{minE} \AgdaBound{a} \AgdaBound{b}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-resp} \AgdaBound{x=y} \AgdaBound{i} \AgdaBound{j} \AgdaSymbol{=} \AgdaFunction{lemma-<=minE}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{snd} \AgdaFunction{resp≤} \AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{x=y}\AgdaSymbol{)} \AgdaBound{i}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{snd} \AgdaFunction{resp≤} \AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{x=y}\AgdaSymbol{)} \AgdaBound{j}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-trans} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaBound{a} \AgdaBound{b}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaBound{y} \AgdaBound{<} \AgdaBound{x} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaBound{a} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{x}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaBound{b}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{\#} \AgdaBound{y}\AgdaSymbol{)} \AgdaFunction{≤} \AgdaFunction{minE} \AgdaBound{a} \AgdaBound{b}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{lemma-trans} \AgdaBound{y<x} \AgdaBound{i} \AgdaBound{j} \AgdaSymbol{=} \AgdaFunction{lemma-<=minE}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{trans≤} \AgdaSymbol{(}\AgdaInductiveConstructor{le} \AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{y<x}\AgdaSymbol{))} \AgdaBound{i}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{(}\AgdaFunction{trans≤} \AgdaSymbol{(}\AgdaInductiveConstructor{le} \AgdaSymbol{(}\AgdaInductiveConstructor{base} \AgdaBound{y<x}\AgdaSymbol{))} \AgdaBound{j}\AgdaSymbol{)}\<%
\\
\>\<\end{code}
\end{frame}

\begin{frame}
  \frametitle{ndmerge}
Слияние поддеревьев \DC{nd}
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{ndmerge} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaBound{h}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaBound{x} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{))} \AgdaInductiveConstructor{full}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaBound{y} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{)} \AgdaInductiveConstructor{full}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaSymbol{(}\AgdaFunction{minE} \AgdaBound{x} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{)))} \AgdaInductiveConstructor{almost}\<%
\\
\>\<\end{code}
\end{frame}
\AgdaHide{
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{ndmerge} \AgdaSymbol{=} \AgdaSymbol{\{!!\}}\<%
\\
\>\<\end{code}
}

\begin{frame}
  \frametitle{afmerge}
Слияние неполной кучи высотой $h+2$ и полной кучи высотой $h+1$ или $h+2$
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{afmerge} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{h} \AgdaBound{x} \AgdaBound{y}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaBound{x} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{))} \AgdaInductiveConstructor{almost}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{OR} \AgdaSymbol{(}\AgdaDatatype{Heap} \AgdaBound{y} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{)} \AgdaInductiveConstructor{full}\AgdaSymbol{)}\<%
\\
\>[4]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{(}\AgdaDatatype{Heap} \AgdaBound{y} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{))} \AgdaInductiveConstructor{full}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{OR} \AgdaSymbol{(}\AgdaDatatype{Heap} \AgdaSymbol{(}\AgdaFunction{minE} \AgdaBound{x} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{))} \AgdaInductiveConstructor{full}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{(}\AgdaDatatype{Heap} \AgdaSymbol{(}\AgdaFunction{minE} \AgdaBound{x} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{)))} \AgdaInductiveConstructor{almost}\AgdaSymbol{)}\<%
\\
\>\<\end{code}
\end{frame}
\AgdaHide{
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{afmerge} \AgdaSymbol{=} \AgdaSymbol{\{!!\}}\<%
\\
\>\<\end{code}
}

\begin{frame}
  \frametitle{apop}
Извлечение минимума из неполной кучи
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{apop} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{h}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{Heap} \AgdaBound{m} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{)} \AgdaInductiveConstructor{almost}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{→} \AgdaDatatype{OR} \AgdaSymbol{(}\AgdaRecord{Σ} \AgdaSymbol{(}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[4]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaSymbol{(λ} \AgdaBound{x} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{Heap} \AgdaBound{x} \AgdaSymbol{(}\AgdaInductiveConstructor{succ} \AgdaBound{h}\AgdaSymbol{)} \AgdaInductiveConstructor{almost}\AgdaSymbol{)} \AgdaFunction{×} \AgdaSymbol{(}\AgdaBound{m} \AgdaFunction{≤} \AgdaBound{x}\AgdaSymbol{)))}\<%
\\
%
\\
\>[8]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{(}\AgdaRecord{Σ} \AgdaSymbol{(}\AgdaDatatype{expanded} \AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaSymbol{(λ} \AgdaBound{x} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{Heap} \AgdaBound{x} \AgdaBound{h} \AgdaInductiveConstructor{full}\AgdaSymbol{)} \AgdaFunction{×} \AgdaSymbol{(}\AgdaBound{m} \AgdaFunction{≤} \AgdaBound{x}\AgdaSymbol{)))}\<%
\\
\>\<\end{code}
\end{frame}
\AgdaHide{
\begin{code}\>\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{apop} \AgdaSymbol{=} \AgdaSymbol{\{!!\}}\<%
\\
\>\<\end{code}
}

